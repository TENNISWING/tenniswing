<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/host/host-layout}">

<th:block layout:fragment="hostcontent">
	<div class="page-content">
		<!-- Main__container Start-->
		<div class="main__container">
			<!-- Main Inner Wrapper Start -->
			<div class="main__inner--wrapper" style="padding: 40px 0;">
					<!-- Product List Start -->
				<div class="row">
					<div class="col-12">
						<div class="dashboard__breadcrumb">
							<div class="breadcrumb__meta">
								<ul style="padding: 0">
									<li><a href="dashboard.html" class="link">Dashboard</a></li>
									<li>Court List</li>
								</ul>
							</div>
						</div>
	
					<!-- Basic Tables start -->
					<div class="dashboard__header">
						<div class="d__header--left">
							<h2 class="title">코트 리스트</h2>
							<div class="danger__btn border-30">500 products</div>
						</div>
						<div class="add__btn" style="margin-right: 1.5rem">
							<a href="hostregisterCourtroom" class="shop-btn shop-btn-primary"><i
								class="fas fa-plus"></i>코트 등록하기</a>
						</div>
					<!-- 	<div style="float: right">
							<button class="btn btn-primary"
								th:onclick="|location.href='@{/hostregisterCourtroom}'|">코트
								등록하기</button>
						</div> -->
					</div>
					<section class="section">
						<div class="card">
	
							<div class="card-body">
								<div class="table-responsive">
									<table class="table" id="table1">
										<thead>
											<tr>
												<th>Court No</th>
												<th>Name</th>
												<th>Location</th>
												<th>Operate Time</th>
												<th>Court Count</th>
												<th>Register Date</th>
												<th>permission</th>
												<th>Button</th>
											</tr>
										</thead>
										<tbody>
											<th:block th:each="courtList, stat : ${courtList}">
												<tr>
													<td id="crtroomNo" th:attrappend="id=${courtList.crtroomNo}">[[
                            ${courtList.crtroomNo} ]]</td>
                          <td>[[ ${courtList.crtroomName} ]]</td>
                          <td>[[ ${courtList.crtroomLocation} ]]</td>
                          <td>[[ ${courtList.crtroomOperateStartTime} ]] ~ [[
                            ${courtList.crtroomOperateEndTime} ]]</td>
                          <td>[[ ${courtList.crtCount} ]]</td>
                          <td>[[
                            ${#dates.format(courtList.crtroomRegiDate,'yyyy년MM월dd일')}
                            ]]</td>
                          <td><span class="badge bg-success" style="background: transparent !important; border: 1px solid #fbd5ce !important; color: #eb5e28 !important">[[${courtList.crtroomStateName}]]</span></td>
                          <td>
                            <div
                              th:onclick="|location.href='@{/hostCourtDetail(crtroomNo=${courtList.crtroomNo})}'|"
                              class="btn icon btn-primary">
                              <i class="icon dripicons dripicons-enter"></i>
                            </div>
                            <div class="btn icon btn-success edit"
                              th:onclick="|location.href='@{/hosteditCourtroom(crtroomNo=${courtList.crtroomNo})}'|"
                              id="courtroomEdit" th:attrappend="id=${stat.index}">
                              <i class="icon dripicons dripicons-pencil"></i>
                            </div>
                            <div class="btn icon btn-danger courtroom"
                              id="courtroomDelete" th:attrappend="id=${courtList.crtroomNo}">
                              <i class="icon dripicons dripicons-trash"></i>
                            </div>
                          </td>
												</tr>
												<!-- Vertically Centered modal Modal -->
												<!-- <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog"
						                aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
						                <div class="modal-dialog modal-dialog-centered modal-dialog-centered modal-dialog-scrollable"
						                    role="document">
						                    <div class="modal-content">
						                        <div class="modal-header">
						                            <h5 class="modal-title" id="exampleModalCenterTitle">Vertically Centered
						                            </h5>
						                            <button type="button" class="close" data-bs-dismiss="modal"
						                                aria-label="Close">
						                                <i data-feather="x"></i>
						                            </button>
						                        </div>
						                        <div class="modal-body">
						                            <button class="btn icon icon-left btn-primary"
						                            th:onclick="|location.href='@{/editCourtroom(crtroomNo=${courtList.crtroomNo})}'|">
						                            	<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" 
						                            	fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" 
						                            	class="feather feather-edit">
							                            	<path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
							                            	<path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
						                            	</svg> 코트장 수정
						                            </button>
						                        </div>
						                        <div class="modal-footer">
						                            <button type="button" class="btn btn-light-secondary"
						                                data-bs-dismiss="modal">
						                                <i class="bx bx-x d-block d-sm-none"></i>
						                                <span class="d-none d-sm-block">Close</span>
						                            </button>
						                        </div>
						                    </div>
						                </div>
						            </div> -->
												</th:block>
											</tbody>
										</table>
									</div>
								</div>
							</div>
						</section>
					</div>
				</div>
			</div>
		</div>
		<!-- Basic Tables end -->
	</div>
	<script th:inline="javascript">
	$('.courtroom').on('click',function(e){
		
		Swal.fire({
			  title: "",
			  text: "정말 삭제하시겠습니까?",
			  icon: "warning",
			  showCancelButton: true,
			  confirmButtonColor: "#3085d6",
			  cancelButtonColor: "#d33",
			  confirmButtonText: "Yes, delete it!"
			}).then((result) => {
			  if (result.isConfirmed) {
			    console.log($(e.target));
				let cnt = $(e.target).prop("id").replace("courtroomDelete","");
				console.log(cnt);
				let courtroomNo = Number($('#crtroomNo'+cnt).text());
				$.ajax({
					type: 'POST',
					url: 'hostdeleteCourtroom',
					data: {crtNo: courtroomNo},
					dataType: 'json',
					success: function(result){
						if(result.result){
							Swal.fire({
								  icon: "success",
								  title: "",
								  text: "정상적으로 삭제되었습니다.",
								}).then(function(){
									location.reload();
								})
						}else{
							Swal.fire({
								  icon: "error",
								  title: "",
								  html: "정상적으로 삭제되지 않았습니다."+"\n예약 건수: "+result.reserveCount+"건",
							})
						}
					}
				})
		  	}
		});
	})
		/* let msg = [[${result}]]
		if(msg != null) alert(msg); */
	</script>

</th:block>
</html>