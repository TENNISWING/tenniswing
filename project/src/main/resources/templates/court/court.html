<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/main-layout}">
<head>
	<style>
		.card {
		  transition: all 0.3s ease;
		}
		.card:hover {
		   box-shadow:
		   -7px -7px 20px 0px #fff9,
		   -4px -4px 5px 0px #fff9,
		   7px 7px 20px 0px #0002,
		   4px 4px 5px 0px #0001;
		}
		body{
			font-family: 'Noto Sans KR', sans-serif !important;
		}
		.page-link.active, .active > .page-link{
			background-color: #3C3C3C;
		}
	</style>
</head>
	<th:block layout:fragment="content">
	

            <!-- slide banner -->
            <!-- <div class="container-fluid mb-2 bg-light-info">
                <div class="container pt-3 pb-3">
                    <div class="swiper mySwiper banner" data-aos="fade-up">
                        <div class="swiper-wrapper banner">
                            <div class="swiper-slide banner text-center">
                                <img src="/assets/img/slide.png" class="img-fluid" alt="">
                            </div>
                            <div class="swiper-slide banner text-center"><img src="/assets/img/slide.png"
                                    class="img-fluid" alt=""></div>
                            <div class="swiper-slide banner text-center"><img src="/assets/img/slide.png"
                                    class="img-fluid" alt=""></div>
                            <div class="swiper-slide banner text-center"><img src="/assets/img/slide.png"
                                    class="img-fluid" alt=""></div>
                            <div class="swiper-slide banner text-center"><img src="/assets/img/slide.png"
                                    class="img-fluid" alt=""></div>
                            <div class="swiper-slide banner text-center"><img src="/assets/img/slide.png"
                                    class="img-fluid" alt=""></div>
                            <div class="swiper-slide banner text-center"><img src="/assets/img/slide.png"
                                    class="img-fluid" alt=""></div>
                        </div>
                        <div class="swiper-pagination banner"></div>
                    </div>
                </div>
                <script>
                    var swiper = new Swiper(".mySwiper.banner", {
                        loop: true,
                        loopPreventsSliding: true,
                        grabCursor: true,
                        autoplay: {
                            delay: 2000,
                            pauseOnMouseEnter: true,
                            disableOnInteraction: false
                        },
                        pagination: {
                            el: ".swiper-pagination.banner",
                            dynamicBullets: true,
                            clickable: true,
                        },
                    });
                </script>
            </div> -->
            <!-- End slide banner -->

			<!-- Banner Slider v2 End-->
			<section class="banner__slider__section__v2 pb-0">
		<div class="container">
			<div class="row">
				<div class="col-xl-12 col-lg-12">
					<div class="swiper main__mySwiper">
						<div class="swiper-wrapper">
							<div class="swiper-slide">
								<div class="single__slide__wrapper"
									style="background-image: url('assets/img/court/tennis-banner13-1.jpg'); height: 350px;">
									<div class="hero__wrapper text-left">
										<!-- <h5 class="hero__subtitle">Limited offer 25% off</h5>  -->
										<h1 class="hero__title">
											<!-- Organic Fruit <br /> For Your Family’s Health -->
										</h1>
										<p class="hero__content"></p>
										<div class="hero__btn">
											<!-- <a href="product.html" class="btn btn-primary">Shop Now</a> -->
										</div>
									</div>
								</div>
							</div>
							<div class="swiper-slide">
								<div class="single__slide__wrapper"
									style="background-image: url('assets/img/court/tennis-banner17-1.jpg'); height: 350px;">
									<div class="hero__wrapper text-left">
										<!-- <h5 class="hero__subtitle">Limited offer 10% off</h5> -->
										<h1 class="hero__title">
											<!-- Shop wise <br /> with price <br /> comparisons -->
										</h1>
										<p class="hero__content"></p>
										<div class="hero__btn">
											<!-- <a href="product.html" class="btn btn-primary">Shop Now</a> -->
										</div>
									</div>
								</div>
							</div>
							<!-- <div class="swiper-slide">
								<div class="single__slide__wrapper"
									style="background-image: url('assets/img/court/tennis-banner15-4.jpg'); height: 350px;">
									<div class="hero__wrapper text-left">
										<h5 class="hero__subtitle">Limited offer 10% off</h5>
										<h1 class="hero__title">
											Summer <br /> Skin care <br /> Product
										</h1> 
										<p class="hero__content"></p>
										<div class="hero__btn">
											<a href="product.html" class="btn btn-primary">Shop Now</a>
										</div>
									</div>
								</div>
							</div> -->
							<div class="swiper-slide">
								<div class="single__slide__wrapper"
									style="background-image: url('assets/img/court/tennis-banner18-1.jpg'); height: 350px;">
									<div class="hero__wrapper text-left">
										<!-- <h5 class="hero__subtitle">Limited offer 10% off</h5> -->
										<h1 class="hero__title">
											<!-- Summer <br /> Skin care <br /> Product -->
										</h1> 
										<p class="hero__content"></p>
										<div class="hero__btn">
											<!-- <a href="product.html" class="btn btn-primary">Shop Now</a> -->
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="banner__navigation">
							<div class="swiper-button-next">
								<svg width="35" height="16" viewBox="0 0 35 16" fill="none"
									xmlns="http://www.w3.org/2000/svg">
                                      <path d="M1 8L34 8"
									stroke="#D0D5DD" stroke-width="2" stroke-linecap="round"
									stroke-linejoin="round" />
                                      <path d="M27 1L34 8L27 15"
									stroke="#D0D5DD" stroke-width="2" stroke-linecap="round"
									stroke-linejoin="round" />
                                	</svg>
							</div>
							<div class="swiper-button-prev">
								<svg width="23" height="16" viewBox="0 0 23 16" fill="none"
									xmlns="http://www.w3.org/2000/svg">
                                        <path d="M22 8H1"
										stroke="#D0D5DD" stroke-width="2" stroke-linecap="round"
										stroke-linejoin="round" />
                                        <path d="M8 15L1 8L8 1"
										stroke="#D0D5DD" stroke-width="2" stroke-linecap="round"
										stroke-linejoin="round" />
                                    </svg>
							</div>
						</div>
					</div>
				</div>

			</div>
		</div>
	</section>
			<!-- Banner Slider v2 End-->
			<!-- courtroom filter -->
	<section class="archive-category" style="padding-top: 30px">
		<div class="container">
            <div class="row align-items-center">
				<div class="col-12" style="height: 50px;">
					<div class="filter__area">
						<div class="section-title__wrap">
							<!-- 필터처리 -->
							<form action="#" class="product-filter">
								<!-- 카테고리 form-select select__style -->
								<div class="select__style" id="firstDrop">
									<select class="category-select" id="crtroomRegion" name="crtroomRegion">
										<option value="">지역 선택</option>
										<option value="b1">서울</option>
                                        <option value="b2">경기</option>
                                        <option value="b3">인천</option>
                                        <option value="b4">강원도</option>
                                        <option value="b5">전라도</option>
                                        <option value="b6">경상도</option>
                                        <option value="b7">충청도</option>
                                        <option value="b8">제주도</option>
									</select>
								</div>
								<button type="button" id="btnreset" class="danger__btn border-30"
									style="background: rgba(18, 183, 106, 0.1) !important; color: #12b76a !important;">초기화</button>
							</form>
						</div>
						<div class="shortBy-select select__style d-lg-flex d-none" id="prodSort">
							<!-- <label for="sortBy2">Filters:</label> -->
							<select name="sortBy" id="sortBy2">
								<option value="0">최신순</option>
								<option value="1">인기순</option>
								<option value="2">낮은 가격순</option>
								<option value="3">높은 가격순</option>
							</select>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
            <!-- courtroom card -->
            <div class="container">
            	<div class="" id="courtList">
                    <th:block th:each="courtList, stat: ${courtList}">
                    <div class="col-xl-4 col-md-6 col-sm-12"
                    style="display: inline-block; width: 270px; margin: 1.2%;
                    		border-radius: 10px; margin-bottom: 2.5%; cursor:pointer; box-shadow: 1px 1px 10px #eee">
                     <div class="card" th:onclick="|location.href='@{/courtDetail(crtroomNo=${courtList.crtroomNo})}'|"
                     	style="margin: 0">
                           	<img th:src="${courtList.attachPath}" class="card-img-top img-fluid"
                                alt="singleminded" style="overfit: cover">
                         <ul class="list-group list-group-flush">
                       	 	 <li class="list-group-item" style="border: 0;"></li>
                         	 <li class="list-group-item rating" style="border: 0;">
                         	 	<th:block th:switch="${courtList.avgStar != null ? courtList.avgStar : 0}">
									<ul th:case="0" class="star">
										<li><i class="fa-regular fa-star"></i></li>
										<li><i class="fa-regular fa-star"></i></li>
										<li><i class="fa-regular fa-star"></i></li>
										<li><i class="fa-regular fa-star"></i></li>
										<li><i class="fa-regular fa-star"></i></li>
									</ul>
									<ul th:case="1" class="star">
										<li><i class="fa-solid fa-star"></i></li>
										<li><i class="fa-regular fa-star"></i></li>
										<li><i class="fa-regular fa-star"></i></li>
										<li><i class="fa-regular fa-star"></i></li>
										<li><i class="fa-regular fa-star"></i></li>
									</ul>
									<ul th:case="2" class="star">
										<li><i class="fa-solid fa-star"></i></li>
										<li><i class="fa-solid fa-star"></i></li>
										<li><i class="fa-regular fa-star"></i></li>
										<li><i class="fa-regular fa-star"></i></li>
										<li><i class="fa-regular fa-star"></i></li>
									</ul>
									<ul th:case="3" class="star">
										<li><i class="fa-solid fa-star"></i></li>
										<li><i class="fa-solid fa-star"></i></li>
										<li><i class="fa-solid fa-star"></i></li>
										<li><i class="fa-regular fa-star"></i></li>
										<li><i class="fa-regular fa-star"></i></li>
									</ul>
									<ul th:case="4" class="star">
										<li><i class="fa-solid fa-star"></i></li>
										<li><i class="fa-solid fa-star"></i></li>
										<li><i class="fa-solid fa-star"></i></li>
										<li><i class="fa-solid fa-star"></i></li>
										<li><i class="fa-regular fa-star"></i></li>
									</ul>
									<ul th:case="5" class="star">
										<li><i class="fa-solid fa-star"></i></li>
										<li><i class="fa-solid fa-star"></i></li>
										<li><i class="fa-solid fa-star"></i></li>
										<li><i class="fa-solid fa-star"></i></li>
										<li><i class="fa-solid fa-star"></i></li>
									</ul>
									</th:block>
								<div class="total__rating" style="font-family: 'Noto Sans KR', sans-serif;">([[${courtList.countReview}]])</div>
                         	 </li>
                         	 <li class="list-group-item" style="border: 0;"><span style="float: left; font-family: 'Noto Sans KR', sans-serif;"><h5 class="card-title">[[ ${courtList.crtroomName} ]]</h5></span></li>
                             <li class="list-group-item" style="border: 0;"><span style="float: left; font-family: 'Noto Sans KR', sans-serif;">[[ ${#numbers.formatInteger(courtList.minPrice, 3, 'COMMA') + '원'} ]] ~</span></li>
                             <li class="list-group-item" style="border: 0;"><span style="float: left; font-family: 'Noto Sans KR', sans-serif;">[[ ${courtList.crtroomLocation} ]]</span></li>
                             <li class="list-group-item" style="border: 0;"></li>
                         </ul>
                        </div>
                    </div>
                 	</th:block>
             	</div>
            </div>
				<div class="container mt-5 mb-5">
					<ul class="pagination justify-content-center">
					</ul>
				</div>
			<!-- 페이징 종료 -->

            <!-- viewed history -->
            <!-- Trending Section Start -->
            <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
			<section class="trending__section pt-0">
				<div class="container">
					<div class="row">
						<div class="col-12">
							<div class="section-title" style="margin: 50px 0 0 0">
								<h2 style="font-size: 25px;"><span style="color: #134631; font-family: 'Noto Sans KR', sans-serif;">최근 등록한 코트장</span></h2>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-12">
							<div class="product__wrapper swiper__pagination">
								<div class="swiper trending__Swiper">
									<div class="swiper-wrapper">
									<th:block th:each="recentCrt, stat : ${recentCrt}">
										<div class="swiper-slide">
											<div class="product-card">
												<div class="product__image__wrapper">
													<a th:onclick="|location.href='@{/courtDetail(crtroomNo=${recentCrt.crtroomNo})}'|" class="product__image"
													> <img
														th:src="${recentCrt.attachPath}" alt="icon" style="object-fit: cover;" />
													</a>
													<div class="badge" >New</div>
												</div>
												<div class="product__content">
													<div class="product__rating">
														<th:block th:switch="${recentCrt.avgStar != null ? recentCrt.avgStar : 0}">
															<ul th:case="0" class="star" style="padding: 0">
																<li><i class="fa-regular fa-star"></i></li>
																<li><i class="fa-regular fa-star"></i></li>
																<li><i class="fa-regular fa-star"></i></li>
																<li><i class="fa-regular fa-star"></i></li>
																<li><i class="fa-regular fa-star"></i></li>
															</ul>
															<ul th:case="1" class="star" style="padding: 0">
																<li><i class="fa-solid fa-star"></i></li>
																<li><i class="fa-regular fa-star"></i></li>
																<li><i class="fa-regular fa-star"></i></li>
																<li><i class="fa-regular fa-star"></i></li>
																<li><i class="fa-regular fa-star"></i></li>
															</ul> 
															<ul th:case="2" class="star" style="padding: 0">
																<li><i class="fa-solid fa-star"></i></li>
																<li><i class="fa-solid fa-star"></i></li>
																<li><i class="fa-regular fa-star"></i></li>
																<li><i class="fa-regular fa-star"></i></li>
																<li><i class="fa-regular fa-star"></i></li>
															</ul>
															<ul th:case="3" class="star" style="padding: 0">
																<li><i class="fa-solid fa-star"></i></li>
																<li><i class="fa-solid fa-star"></i></li>
																<li><i class="fa-solid fa-star"></i></li>
																<li><i class="fa-regular fa-star"></i></li>
																<li><i class="fa-regular fa-star"></i></li>
															</ul>
															<ul th:case="4" class="star" style="padding: 0">
																<li><i class="fa-solid fa-star"></i></li>
																<li><i class="fa-solid fa-star"></i></li>
																<li><i class="fa-solid fa-star"></i></li>
																<li><i class="fa-solid fa-star"></i></li>
																<li><i class="fa-regular fa-star"></i></li>
															</ul>
															<ul th:case="5" class="star" style="padding: 0">
																<li><i class="fa-solid fa-star"></i></li>
																<li><i class="fa-solid fa-star"></i></li>
																<li><i class="fa-solid fa-star"></i></li>
																<li><i class="fa-solid fa-star"></i></li>
																<li><i class="fa-solid fa-star"></i></li>
															</ul>
															</th:block>
														<div class="total__rating" style="font-family: 'Noto Sans KR', sans-serif;">([[${recentCrt.countReview}]])</div>
													</div>
													<div class="product__title">
														<h5>
															<a th:onclick="|location.href='@{/courtDetail(crtroomNo=${recentCrt.crtroomNo})}'|"
															   style="font-family: 'Noto Sans KR', sans-serif;">[[${recentCrt.crtroomName}]]</a>
														</h5>
													</div>
													<div class="product__bottom">
														<div class="product__price price" style="font-family: 'Noto Sans KR', sans-serif;">
															[[${#numbers.formatInteger(recentCrt.minPrice, 3, 'COMMA') + '원'}]] ~
															<!-- <del>$22.00</del> -->
														</div>
														<script>
														</script>
														<div class="cart__action__btn">
															<div class="cart__btn">
																<button type="button" th:onclick="|location.href='@{/courtDetail(crtroomNo=${recentCrt.crtroomNo})}'|" class="btn btn-outline" 
																style="font-family: 'Noto Sans KR', sans-serif;">상세보기</button>
															</div>
															<!-- <div class="quantity cart__quantity">
																<button type="button" class="decressQnt">
																	<span class="bar"></span>
																</button>
																<input class="qnttinput" type="number" disabled value="0"
																	min="01" max="100" />
																<button type="button" class="incressQnt">
																	<span class="bar"></span>
																</button>
															</div> -->
														</div>
													</div>
												</div>
											</div>
										</div>
										</th:block>
									</div>
		
									<div class="swiper-button-next">
										<svg width="35" height="16" viewBox="0 0 35 16" fill="none"
											xmlns="http://www.w3.org/2000/svg">
		                                           <path d="M1 8L34 8"
												stroke="#D0D5DD" stroke-width="2" stroke-linecap="round"
												stroke-linejoin="round" />
		                                           <path d="M27 1L34 8L27 15"
												stroke="#D0D5DD" stroke-width="2" stroke-linecap="round"
												stroke-linejoin="round" />
		                                       </svg>
									</div>
									<div class="swiper-button-prev">
										<svg width="23" height="16" viewBox="0 0 23 16" fill="none"
											xmlns="http://www.w3.org/2000/svg" style="width: 85%">
		                                        <path d="M22 8H1"
												stroke="#D0D5DD" stroke-width="2" stroke-linecap="round"
												stroke-linejoin="round" />
		                                        <path d="M8 15L1 8L8 1"
												stroke="#D0D5DD" stroke-width="2" stroke-linecap="round"
												stroke-linejoin="round" />
		                                    </svg>
									</div>
									<!-- <div class="swiper-slide"></div> -->
									<div class="swiper-pagination"></div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</section>
			<!-- Trending Section End -->
            <!-- End viewed history -->
		<script>
		courtAjax(1);
		$('#crtroomRegion').on('change', function(e) {
			pageNum = 1;
			courtAjax(1);
		});
		$('#sortBy2').on('change', function(e) {
			pageNum = 1;
			courtAjax(1);
		})
		
		$('#btnreset').on('click', function(e) {
			$('#firstDrop div span').text('지역 선택');
			$('#firstDrop div ul li:first-child').addClass('selected','focus');
			$('#firstDrop div ul li').not(':first').attr('class', 'option');
			$('#crtroomRegion').val('').prop('selected',true);
			pageNum = 1;
			courtAjax(1);
		});
		
		function courtAjax(page) {
			let crtroomRegion = $('#crtroomRegion').val();
			let sortBy2 = $('#sortBy2').val();
			let sort = $('#sortBy2').val();
			if(sort == 0)
				sort = 'c.crtroom_regi_date DESC';
			else if(sort == 1)
				sort = 'COUNT(r.review_no) DESC';
			else if(sort == 2)
				sort = 'min_price';
			else if(sort == 3)
				sort = 'min_price DESC';
			
			$.ajax({
				type: 'GET',
				url: 'courtAjax',
				data: {page, crtroomRegion, sort},
				success: function(result){
					console.log(result.courtList);
					$('#courtList').empty();
					for(let courtList of result.courtList){
						let b = `
							<div class="col-xl-4 col-md-6 col-sm-12"
		                    style="display: inline-block; width: 270px; margin-left: 1.25%; margin-right: 1.25%;
		                    		border-radius: 10px; margin-bottom: 2.5%; cursor:pointer; box-shadow: 1px 1px 10px #eee">
		                     <div class="card" onclick='location.href="courtDetail?crtroomNo=${courtList.crtroomNo}"'
		                     	style="margin: 0;">
		                           	<img src="${courtList.attachPath}" class="card-img-top img-fluid"
		                                alt="singleminded" style="height: 202px; over-fit: cover">
		                         <ul class="list-group list-group-flush">
		                       	 	 <li class="list-group-item" style="border: 0;"></li>
		                         	 <li class="list-group-item rating" style="border: 0;">
											<ul class="star" style="padding: 0; margin: 0;">`
							let avgStarStar = 0;
							if(courtList.avgStar != null){
								avgStarStar = Number(courtList.avgStar);
								console.log(avgStarStar);
							}
							for(let i=0; i< avgStarStar; i++){
								b+= `<li><i class="fa-solid fa-star"></i></li>`;
							}
							for(let j=0; j<5-avgStarStar; j++){
								b+= `<li><i class="fa-regular fa-star"></i></li>`;
							}
							
							let minPrice = courtList.minPrice.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
							//let minPriceFormat = minPrice.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
							b+=	`</ul>
								<div class="total__rating">(`+courtList.countReview+`)</div>
		                         	 </li>
		                         	 <li class="list-group-item" style="border: 0;"><span style="float: left;"><h5 class="card-title crtroomNameCss" style="font-family: 'Noto Sans KR', sans-serif;">`+courtList.crtroomName+`</h5></span></li>
		                             <li class="list-group-item" style="border: 0;"><span style="float: left; font-weight: bold; color: #FF9966; font-family: 'Noto Sans KR', sans-serif;" class="price">`+minPrice+`원 ~</span></li>
		                             <li class="list-group-item" style="border: 0;"><span style="float: left; font-family: 'Noto Sans KR', sans-serif; height: 50px;">`+courtList.crtroomLocation+`</span></li>
		                             <li class="list-group-item" style="border: 0;"></li>
		                         </ul>
		                        </div>
		                    </div>
						`;
						$('#courtList').append(b);
					}
					
					showPage(result.selectCount);
				}
			})
		}
			
		$('.pagination').on("click","li a", function(e) {
		
			e.preventDefault();
			console.log("page click");
			
			var targetPageNum = $(this).attr("href");
			
			console.log("targetPageNum: " + targetPageNum);
			
			pageNum = targetPageNum;
			
			courtAjax(targetPageNum);
			window.scrollTo(0,0);
		});
		
		pageNum = 1;
		pageSize = 10.0; //페이지 번호 수
		pageUnit = 12;  //한페이지에 출력할 행의 수
		// 페이징
		function showPage(replyCnt) {
			
			var endNum = Math.ceil(pageNum / pageSize) * pageSize;
			var startNum = endNum > pageSize? endNum - pageSize : 1;
			
			var prev = startNum != 1;
			var next = false;
			
			if(endNum * 10 >= replyCnt) {
				endNum = Math.ceil(replyCnt/pageUnit);
			}
			
			if(endNum * 10 < replyCnt) {
				next = true;
			}
			
			var str= "";
			
			if(prev) {
				str+= "<li class='page-item'><a class='page-link' href='"+(startNum -1)+"'>Previous</a></li>";
			}
			
			for(var i = startNum ; i <= endNum; i++) {
				var active = pageNum == i? "active":"";
				str+= "<li class='page-item "+active+"'> <a class='page-link' href='"+i+"'>"+i+"</a></li>";		
			}
			
			if(next) {
				str+= "<li class='page-item'><a class='page-link' href='"+(endNum + 1)+"'>Next</a><li>";
			}
			
			str += "";
			
			console.log(str);
			
			$('.pagination').html(str);
		}
		
		function changePrice() {		
			let price = $('.price');
			
			//console.log($(price).attr('id'));
			//console.log([[ ${newProd} ]]);
			
			price.each(function(){
				//console.log($(this).text());
				//console.log($(this).attr('id'));
				priceId = $(this).attr('id');
				// jQuery id 찾을 때 변수 넣어서 찾기
				//console.log($('#'+priceId));
				
				let changePrice = $('#'+priceId).text();
				changePrice = changePrice.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				
				changePrice = changePrice + '원';
				$('#'+priceId).text(changePrice);
			});
		}
	
		new Swiper(".swiper-wrapper", {
			/* loop : true, */
			loopPreventsSliding : true,
			grabCursor : true,
			slidesPerView : 3,
			spaceBetween : 20,
	
			/* autoplay : {
				delay : 2000,
				pauseOnMouseEnter : true,
				disableOnInteraction : false
			}, */
			pagination : {
				el : ".swiper-pagination",
				dynamicBullets : true,
				clickable : true,
			},
		});
		
		function gopage(page){
			location.href="court?page="+page
		}
		</script>
	</th:block>
</html>